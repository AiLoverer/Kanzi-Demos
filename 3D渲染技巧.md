<!--
 * ......................................&&.........................
 * ....................................&&&..........................
 * .................................&&&&............................
 * ...............................&&&&..............................
 * .............................&&&&&&..............................
 * ...........................&&&&&&....&&&..&&&&&&&&&&&&&&&........
 * ..................&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&..............
 * ................&...&&&&&&&&&&&&&&&&&&&&&&&&&&&&.................
 * .......................&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&.........
 * ...................&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&...............
 * ..................&&&   &&&&&&&&&&&&&&&&&&&&&&&&&&&&&............
 * ...............&&&&&@  &&&&&&&&&&..&&&&&&&&&&&&&&&&&&&...........
 * ..............&&&&&&&&&&&&&&&.&&....&&&&&&&&&&&&&..&&&&&.........
 * ..........&&&&&&&&&&&&&&&&&&...&.....&&&&&&&&&&&&&...&&&&........
 * ........&&&&&&&&&&&&&&&&&&&.........&&&&&&&&&&&&&&&....&&&.......
 * .......&&&&&&&&.....................&&&&&&&&&&&&&&&&.....&&......
 * ........&&&&&.....................&&&&&&&&&&&&&&&&&&.............
 * ..........&...................&&&&&&&&&&&&&&&&&&&&&&&............
 * ................&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&............
 * ..................&&&&&&&&&&&&&&&&&&&&&&&&&&&&..&&&&&............
 * ..............&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&....&&&&&............
 * ...........&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&......&&&&............
 * .........&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&.........&&&&............
 * .......&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&...........&&&&............
 * ......&&&&&&&&&&&&&&&&&&&...&&&&&&...............&&&.............
 * .....&&&&&&&&&&&&&&&&............................&&..............
 * ....&&&&&&&&&&&&&&&.................&&...........................
 * ...&&&&&&&&&&&&&&&.....................&&&&......................
 * ...&&&&&&&&&&.&&&........................&&&&&...................
 * ..&&&&&&&&&&&..&&..........................&&&&&&&...............
 * ..&&&&&&&&&&&&...&............&&&.....&&&&...&&&&&&&.............
 * ..&&&&&&&&&&&&&.................&&&.....&&&&&&&&&&&&&&...........
 * ..&&&&&&&&&&&&&&&&..............&&&&&&&&&&&&&&&&&&&&&&&&.........
 * ..&&.&&&&&&&&&&&&&&&&&.........&&&&&&&&&&&&&&&&&&&&&&&&&&&.......
 * ...&&..&&&&&&&&&&&&.........&&&&&&&&&&&&&&&&...&&&&&&&&&&&&......
 * ....&..&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&...........&&&&&&&&.....
 * .......&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&..............&&&&&&&....
 * .......&&&&&.&&&&&&&&&&&&&&&&&&..&&&&&&&&...&..........&&&&&&....
 * ........&&&.....&&&&&&&&&&&&&.....&&&&&&&&&&...........&..&&&&...
 * .......&&&........&&&.&&&&&&&&&.....&&&&&.................&&&&...
 * .......&&&...............&&&&&&&.......&&&&&&&&............&&&...
 * ........&&...................&&&&&&.........................&&&..
 * .........&.....................&&&&........................&&....
 * ...............................&&&.......................&&......
 * ................................&&......................&&.......
 * .................................&&..............................
 * ..................................&..............................
 * 
 * @Author: XQ
 * @Date: 2025-01-20 10:21:20
 * @LastEditTime: 2025-01-20 15:47:38
 * @LastEditors: XQ
 * @Description: 
 * @FilePath: \undefinedd:\xuqiang\github\Kanzi-Demos\3D渲染技巧.md
 -->


<span style="color: red;">[**声明：本仓库内所有内容仅用于学习、非商业用途。如有侵权、联系删除！qq邮箱：447533920@qq.com**]</span>

# 3D 渲染技巧
## 技巧一：如何限制Camera旋转范围角度在-180°到180°
```
sx=MOD({@../../../Scroll View 2D/ScrollViewConcept.ScrollPosition}.x,360)
m = STEP(180,sx)
#Negative Rotation
n = m * (sx-360)
#Positive Rotation
p = (1 - m) * sx
r = (n + p)
createRotationY(r)
```  

1. 计算标准化角度   
(sx)sx = MOD({@../../../Scroll View 2D/ScrollViewConcept.ScrollPosition}.x, 360)  
•解释：从 Scroll View 2D/ScrollViewConcept.ScrollPosition 获取水平滚动位置的 x 坐标，并使用 MOD 函数将其值限制在 0 到 360 度之间。这确保了角度值始终在一个完整的圆周内。
2. 判断是否超过   
180 度 (m)m = STEP(180, sx)    
解释：使用 STEP 函数检查 sx 是否大于或等于 180 度。如果 sx >= 180，则 m 的值为 1；否则为 0。•目的：确定角度是否需要转换为负数以保持在 -180 到 180 度之间。
3. 计算负旋转  
(n)#Negative Rotation  
n = m * (sx - 360)  
解释：当 m 为 1（即 sx >= 180）时，计算 sx - 360，将角度转换为负值。这样可以确保角度在 -180 到 0 度之间。•目的：处理超过 180 度的角度，使其变为负值。  
4. 计算正旋转 (p)#Positive Rotation  
p = (1 - m) * sx  
•解释：当 m 为 0（即 sx < 180）时，直接使用 sx 作为正旋转角度。这确保角度在 0 到 180 度之间。•目的：处理小于 180 度的角度，保持其正值。  
5. 合并结果   
(r)r = (n + p)  
•解释：将负旋转和正旋转的结果相加，得到最终的旋转角度 r。由于 m 和 (1 - m) 是互斥的（一个为 1 时另一个为 0），因此只有一个分支会生效。  
•目的：确保最终角度 r 在 -180 到 180 度之间。  
6. 应用旋转  
createRotationY(r)  
•解释：使用 createRotationY 函数应用计算出的 r 角度，使相机绕 Y 轴旋转。  
•目的：确保相机旋转角度保持在合理范围内，避免过度旋转，提供流畅且受控的动画行为。   
**代码的作用**  
这段代码的主要目的是确保相机的旋转角度始终保持在 -180 度到 180 度之间，防止在状态转换期间出现过度旋转的情况。具体来说：  
•标准化角度：通过 MOD 函数确保角度值在 0 到 360 度之间。  
•限制范围：使用 STEP 函数判断角度是否超过 180 度，并根据情况调整为负值或正值。  
•平滑过渡：通过计算负旋转和正旋转，确保角度变化平滑自然，不会突然跳变。  
**总结**  
此绑定表达式有效地管理了相机的旋转角度，确保其在合理范围内变化，从而提供了更流畅且受控的动画效果。

## 技巧二：混合强度场景过渡效果
    说明：Environment_Switch为环境自定义强度值
场景1：
```
MAX(1-{@../Environment_Switch}*2,0)
```
场景2：
```
MIN((({@../Environment_Switch}-0.499)*2),1)
```
**表达式**   
 MAX(1 - {@../Environment_Switch} * 2, 0)  
**解析**   
- {@../Environment_Switch}：假设这是一个从 0.0 到 1.0 之间的浮点数值，表示某个环境开关的状态。•1 - {@../Environment_Switch} *    
- 如果 Environment_Switch 为 0.0，则结果为 1.0。
- 如果 Environment_Switch 为 1.0，则结果为 -1.0。
- 中间值（例如 0.5）会得到 0.0。•MAX(..., 0)：确保最终结果不低于 0。  

**结果**   
- 当 Environment_Switch 小于 0.5 时，结果线性地从 1.0 减少到 0.0。
- 当 Environment_Switch 大于或等于 0.5 时，结果固定为 0.0。

**表达式**   
 MIN((({@../Environment_Switch} - 0.499) * 2), 1)  
**解析**
- {@../Environment_Switch}：同上，假设是一个从 0.0 到 1.0 之间的浮点数值。
- {@../Environment_Switch} - 0.499： 
- 这个操作将 Environment_Switch 的值向左平移了 0.499。
- (... * 2)： 将平移后的值放大两倍。
- MIN(..., 1)：确保最终结果不超过 1。  

**结果**
- 当 Environment_Switch 小于 0.499 时，结果接近 0.0。
- 当 Environment_Switch 在 0.499 到 0.999 之间时，结果线性地从 0.0 增加到 1.0。
- 当 Environment_Switch 大于或等于 0.999 时，结果固定为 1.0。

**应用场景**  
这些表达式可以用于以下场景：
- 状态切换：例如，控制某些 UI 元素的显示或隐藏，或者在不同模式之间进行切换。
- 阈值处理：当需要根据某个输入值的变化来触发不同的行为或效果时。
- 动画控制：通过平滑过渡来实现更自然的视觉效果。